// const や let を使うと２回目以降にエラーが発生
var messageHeight = messageContainer.scrollHeight
// 今回は上にメッセージを追加
messageContainer.insertAdjacentHTML('afterbegin', "<%= j(render @messages) %>")

var newMessageHeight = messageContainer.scrollHeight
window.scrollBy(0, newMessageHeight - messageHeight)

// メッセージが存在するときだけ，読み込み可能とする
<% if @messages.present? %>
    showAdditionally = true
<% end %>
